<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../paper-card/paper-card.html">
<link rel="import" href="../paper-styles/color.html">

<!--
@demo demo/index.html
-->

<dom-module id="swipe-voting-card">
  <template>
    <style>
      .accept > #swipe-overlay {
        background: var(--paper-green-500);
      }

      .accept {
        --paper-card-header-color: var(--paper-green-500);
        transform: translate(150px, 0px);
        transition: transform 500ms;
        opacity: 0.5;
      }

      .reject > #swipe-overlay {
        background: var(--paper-red-500);
      }

      .reject {
        --paper-card-header-color: var(--paper-red-500);
        transform: translate(-150px, 0px);
        transition: transform 500ms;
        opacity: 0.5;
      }

      #swipe-overlay {
        position: absolute;
        z-index: 5;
        opacity: 0.5;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%; 
      }

      paper-card {
        position: relative;
        z-index: 0;
      }

      paper-card > .title-text {
        text-decoration: none;
      }
  </style>

  
  <paper-card heading="{{cardTitle}}">
    <div id="swipe-overlay" on-track="handleTrack"></div>
    <div class="card-content"><content></content></div>
  </paper-card>

</template>

<script>
  Polymer({
    is: 'swipe-voting-card',

    properties: {
      backgroundColor: {
        type: String,
        notify: true,
        observer: '_backgroundColorChanged'
      },

      color: {
        type: String,
        notify: true,
        observer: '_colorChanged'
      },

      cardTitle: {
        type: String
      }
    },

    _backgroundColorChanged: function(backgroundColor) {
      this.$$('paper-card').style.backgroundColor = backgroundColor;
    },

    _colorChanged: function(color) {
      this.$$('paper-card').$$('.title-text').style.color = color;
    },

    handleTrack: function(event) {
      switch(event.detail.state) {
          case 'start':
            console.log("start tracking @ "+event.detail.x)
            this.position = event.detail.x;
            break;
          case 'track':
            var tolerance = 10;
            console.log(this.position+tolerance)
            console.log(event.detail.x)
            console.log(event.detail.x > this.position+tolerance)
            if(event.detail.x > this.position+tolerance) {
              this.$$('paper-card').classList.add('accept');
              this.$$('paper-card').classList.remove('reject');
            }
            else if(event.detail.x < this.position-tolerance){
              this.$$('paper-card').classList.add('reject')
              this.$$('paper-card').classList.remove('accept');         
            }
            else {
              this.$$('paper-card').classList.remove('accept');
              this.$$('paper-card').classList.remove('reject');  
            }
            break;
          case 'end':
            this.$$('paper-card').classList.remove('accept');
            this.$$('paper-card').classList.remove('reject');  
        }
    }

  });
</script>
</dom-module>
